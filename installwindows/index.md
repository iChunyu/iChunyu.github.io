# Windows 系统安装


最近女朋友的电脑被她玩挂了，我决定写一篇文章教她如何重装系统。

<!--more-->


## 安装前的准备

重装系统之前，最重要的事情就是备份了：遍历一下自己经常使用的文件夹，把重要的文件拷贝到 U 盘或者移动硬盘里备份，以免重装系统时丢失或损坏。

{{< admonition danger >}}
一定要备份！一定要备份！一定要备份！
{{< /admonition >}}

备份好数据后，就可以正式准备安装系统了。首先需要下载系统镜像，可以从 [I Tell You](https://msdn.itellyou.cn) 下载。然后有两种方法安装系统：

- 将下载好的镜像文件（`.iso` 文件）通过烧写软件（例如 [Rufus](https://rufus.ie/en/)）写入 U 盘，重启电脑，将 U 盘作为光盘安装系统；
- 将 U 盘制作成 PE 系统，重启后进入 U 盘的 PE 系统进行安装。

一般来说，我比较建议使用第二种方法。一方面，优秀的 PE 自带很多工具可以辅助系统安装；另一方面，PE 盘还可以用于 Windows 系统救急，比如利用其内置的工具可以很容易修改 Windows 密码（可见 Windows 系统密码并不安全）。

在我试过的各种 PE 制作软件中，[微 PE 工具箱](https://www.wepe.com.cn) 是我最爱的一款，至少具有工具齐全、无广告、无捆绑软件等优点。鉴于我经常白嫖它的便利，不妨在此为其做个广告。

为了制作 PE 盘，需要准备 U 盘。应当注意，制作 PE 盘会格式化 U 盘，因此重要文件不要放在 U 盘里（千万别把前面备份的 U 盘拿来做启动盘）。插入 U 盘，使用管理员权限运行微 PE 工具箱，选择安装进 U 盘后，按照提示选择 U 盘、文件系统（推荐 NTFS）等即可完成安装。PE 盘制作完成后，记得将下载好的系统镜像拷贝到该 U 盘内。


## 通过 PE 安装系统

制作好 PE 盘后，重启系统。一般在电脑出现 LOGO 后立马按 `F12` 键选择启动盘，但不同电脑的快捷键可能有所不同。操作正常的话，电脑应当会出现硬盘/U 盘列表，选择刚才制作的 U 盘，按回车进入 PE 系统。

<div align=center>
    <img src=win01.png width=80% />
</div>

微 PE 工具箱内置了很多工具，这里我们打开 Windows 安装器。在不做任何操作时，右侧 EFI 旁边的灯通常不是绿色，说明分区存在问题。这是先暂时退出 Windows 安装器，打开分区助手重新进行分区（因为涉及到重新分区，所以原硬盘的数据可能会格式化，这也是一再强调备份的主要原因）。

<div align=center>
    <img src=win02.png width=60% />
</div>

从分区助手的硬盘列表可以看到当前的所有硬盘和 U 盘信息，熟悉分区的老手可以自行分区，不熟悉的同学可以直接右键硬盘，选择快速分区，如下图所示。

<div align=center>
    <img src=win03.png width=60% />
</div>

我们来看看分区设置。首先确认下硬盘是我们所选的硬盘，即需要安装系统的硬盘。分区的数量根据个人喜好进行选择。一般我比较推荐单独使用一个分区安装系统和软件，使用额外的分区单独存放数据，例如新建一个数据分区存放个人重要文件，新建一个文件分区存放一般性文件等。这里我使用两个分区进行示意，右侧适当调整分区大小，并起个好听的名字就可以了。

硬盘的类型可以无脑选择 GPT, 这是一种新的分区表，有兴趣的同学可以自行查阅相关内容。其他选项可以参考我的设置，勾选“重建 MBR”和“创建 ESP 和 MSR 分区”，这是前面 EFI 黄灯的主要原因。对于固态硬盘，应当将分区对齐到 4096 扇区。

OK，准备就绪，执行分区操作即可。

分区完成后推出分区助手，重新打开 Windows 安装器，依次执行：

- 选择 Windows 安装文件的位置：点击搜索，选择之前下载的系统镜像文件即可；
- 选择引导驱动器的位置：点击搜索，选择待装系统硬盘上的 FAT32 分区，这个分区是上面分区时自动创建的，通常没有 C、D、E 这种盘符。这时候右侧 EFI 应当变为绿灯；
- 选择安装驱动器的位置：点击搜索，选择待装系统硬盘上的系统分区，这是分区时手动创建的，盘符一般为 C,但不重要（Windows 安装好了后会重置为 C）；
- 选项：选择 Windows 版本。一个系统镜像通常具有多个版本，应当注意选择合适的版本。

<div align=center>
    <img src=win04.png width=60% />
</div>

点击安装，等待、重启，就完事了。

在我写这篇博客时，发现了微 PE 官方提供的 [微 PE 安装系统教程](https://www.wepe.com.cn/ubook/)，如果此文无法解决你的问题，不妨参考一下这个教程。



## 推荐一些实用软件

系统安装完成后，最麻烦的就是安装软件了。不过 Windows 下还是有很多有趣的软件，这里简要列举其中一二，有兴趣的同学可以自行折腾。

- [Dism++](https://github.com/Chuyu-Team/Dism-Multi-language)：对 Windows 进行深度配置；
- [Everything](https://www.voidtools.com)：快速查找电脑里的文件；
- [Snipaste](https://www.snipaste.com)：截图与贴图工具；
- [坚果云](https://www.jianguoyun.com)：超好用的同步网盘；
- [PotPlayer](https://potplayer.daum.net)：最好的视频播放软件（官网经常无法打开）；
- [Motrix](https://motrix.app)：美丽的下载软件；
- [Capslock+](https://capslox.com/capslock-plus)：更改大写锁定键功能；
- [PowerToys](https://github.com/microsoft/PowerToys)：Windows 强化工具；
- [Cmder](https://cmder.net)：Windows 终端美化。
