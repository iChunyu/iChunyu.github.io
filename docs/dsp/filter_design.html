

<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>信号的滤波 &mdash; 某春雨的后花园  文档</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../_static/mystyle.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/misaka.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script src="../_static/translations.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="next" title="LPSD 功率谱估计" href="lpsd.html" />
    <link rel="prev" title="信号的微分" href="signal_diff.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> 某春雨的后花园
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">目录</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../misc/index.html">杂乱的技能树</a></li>
<li class="toctree-l1"><a class="reference internal" href="../control/index.html">控制理论学习记录</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">数字信号处理</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="kalman_filter.html">卡尔曼滤波</a></li>
<li class="toctree-l2"><a class="reference internal" href="signal_diff.html">信号的微分</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">信号的滤波</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id2">滤波器的参数及分类</a></li>
<li class="toctree-l3"><a class="reference internal" href="#iir">IIR 滤波器设计</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fir">FIR 滤波器设计</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">零相位滤波</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="lpsd.html">LPSD 功率谱估计</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../latex/index.html">LaTeX 学习记录</a></li>
<li class="toctree-l1"><a class="reference internal" href="../matlab/index.html">MATLAB 使用技巧</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">某春雨的后花园</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">数字信号处理</a> &raquo;</li>
        
      <li>信号的滤波</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/dsp/filter_design.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="id1">
<h1>信号的滤波<a class="headerlink" href="#id1" title="永久链接至标题">¶</a></h1>
<p>我们在 <a class="reference internal" href="../control/MC01_SysDescribe.html"><span class="doc">现代控制基础（1）：系统的描述</span></a> 曾提到过线性系统的传递函数，其意味着系统对不同频率信号的幅度和相位有不同的响应，据此可以实现信号在频域上的分离，这就是所谓的滤波，相应的系统称为滤波器。无论是 MATLAB 还是 Python 都具有特定的函数对常用的线性滤波器进行设计，本文将简要介绍这些函数及其用法，不会对滤波器设计细节做过多的讨论。</p>
<hr class="docutils" />
<div class="section" id="id2">
<h2>滤波器的参数及分类<a class="headerlink" href="#id2" title="永久链接至标题">¶</a></h2>
<p>滤波器的性能通常以其幅频响应为评估依据，主要包括以下四个参数：</p>
<ul class="simple">
<li><p>通带内的纹波 <span class="math notranslate nohighlight">\(R_{\rm pass}\)</span> ：滤波器的频率相应不一定是平坦的，用该参数表征滤波器在通带内的增益允许波动的范围，单位为 <span class="math notranslate nohighlight">\(\rm dB\)</span> ；</p></li>
<li><p>阻带内的衰减 <span class="math notranslate nohighlight">\(R_{\rm stop}\)</span> ：阻带内的信号相比于通带信号的衰减，以 <span class="math notranslate nohighlight">\(\rm dB\)</span> 表示；</p></li>
<li><p>通带频率 <span class="math notranslate nohighlight">\(f_{\rm pass}\)</span> ：在这个频率范围内，滤波器的增益变动不超过通带纹波的约束；</p></li>
<li><p>阻带频率 <span class="math notranslate nohighlight">\(f_{\rm stop}\)</span> ：在这个频率范围内，滤波器对信号的衰减达到阻带衰减倍数的需求。</p></li>
</ul>
<p>以低通滤波器为例，上述四个参数可以用下图来表示</p>
<div class="figure align-center" style="width: 60%">
<img alt="../_images/filter01.png" src="../_images/filter01.png" />
</div>
<p>在对延时比较敏感的实时系统中，还需要讨论滤波器的群延时，其定义为相频响应的负导数，即</p>
<div class="math notranslate nohighlight">
\[\tau_g = -\frac{\mathrm{d}\varphi(\omega)}{\omega}\]</div>
<p>根据滤波器实现方法的不同，可以将其分为模拟滤波器和数字滤波器，前者用于处理连续信号，主要通过模拟电路实现，以拉普拉斯变换为主要的分析工具；后者则用于处理采样后的离散信号，可以部署在各种数字器件，以 <span class="math notranslate nohighlight">\(z\)</span> 变换为主要分析工具。</p>
<p>依据冲击响应还可以将滤波器分为无限脉冲响应（IIR）和有限脉冲响应（FIR），从时域上看，两者的区别在于滤波器的冲击响应是否在有限时间内收敛到 <span class="math notranslate nohighlight">\(0\)</span> ；从频域上看，IIR 滤波器的传递函数具有至少一个极点（传递函数的分母包含 <span class="math notranslate nohighlight">\(s\)</span> 或 <span class="math notranslate nohighlight">\(z^{-1}\)</span> ），而 FIR 滤波器不具有极点，因此也称其为纯零点滤波器。</p>
</div>
<div class="section" id="iir">
<h2>IIR 滤波器设计<a class="headerlink" href="#iir" title="永久链接至标题">¶</a></h2>
<p>常用的 IIR 滤波器有巴特沃斯滤波器、切比雪夫 I 型滤波器、切比雪夫 II 型滤波器和椭圆滤波器。为了精确指定滤波器特性，先使用函数计算滤波器的阶数和带宽，然后再对滤波器系数进行设计。在 MATLAB 中，相应的设计函数如下表所示。</p>
<table class="docutils align-center" id="id4" style="width: 80%">
<caption><span class="caption-text">IIR 模拟滤波器设计 MATLAB 函数</span><a class="headerlink" href="#id4" title="永久链接至表格">¶</a></caption>
<colgroup>
<col style="width: 23%" />
<col style="width: 42%" />
<col style="width: 35%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>滤波器</p></th>
<th class="head"><p>求解阶数和带宽</p></th>
<th class="head"><p>滤波器设计</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>巴特沃斯滤波器</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[n,Wn]</span> <span class="pre">=</span> <span class="pre">buttord(Wp,Ws,Rp,Rs,'s')</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[b,a]</span> <span class="pre">=</span> <span class="pre">butter(n,Wn,'s')</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>切比雪夫 I 型滤波器</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[n,Wn]</span> <span class="pre">=</span> <span class="pre">cheb1ord(Wp,Ws,Rp,Rs,'s')</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[b,a]</span> <span class="pre">=</span> <span class="pre">cheby1(n,Rp,Wn,'s')</span></code></p></td>
</tr>
<tr class="row-even"><td><p>切比雪夫 II 型滤波器</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[n,Wn]</span> <span class="pre">=</span> <span class="pre">cheb2ord(Wp,Ws,Rp,Rs,'s')</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[b,a]</span> <span class="pre">=</span> <span class="pre">cheby2(n,Rs,Wn,'s')</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>椭圆滤波器</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[n,Wn]</span> <span class="pre">=</span> <span class="pre">ellipord(Wp,Ws,Rp,Rs,'s')</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[b,a]</span> <span class="pre">=</span> <span class="pre">ellip(n,Rp,Rs,Wn,'s')</span></code></p></td>
</tr>
</tbody>
</table>
<p>上表中， <code class="docutils literal notranslate"><span class="pre">'s'</span></code> 选项对应的是模拟滤波器，这时 <code class="docutils literal notranslate"><span class="pre">Wp</span></code> 和 <code class="docutils literal notranslate"><span class="pre">Ws</span></code> 的单位都是 <span class="math notranslate nohighlight">\(\rm rad/s\)</span> ， <code class="docutils literal notranslate"><span class="pre">Rp</span></code> 和 <code class="docutils literal notranslate"><span class="pre">Rs</span></code> 的单位均为 <span class="math notranslate nohighlight">\(\rm dB\)</span> 。对于数字滤波器，调用函数时应当取消 <code class="docutils literal notranslate"><span class="pre">'s'</span></code> 选项，并且频率采用归一化的数字频率。</p>
<p>对于 Python 用户， <code class="docutils literal notranslate"><span class="pre">scipy.signal</span></code> 提供了同名的函数，使用方法基本一致，但 <code class="docutils literal notranslate"><span class="pre">'s'</span></code> 选项应更换为关键字参数 <code class="docutils literal notranslate"><span class="pre">analog=True</span></code> 。</p>
<p>以 <code class="docutils literal notranslate"><span class="pre">Wp=1</span></code> ， <code class="docutils literal notranslate"><span class="pre">Ws=3</span></code> ， <code class="docutils literal notranslate"><span class="pre">Rp=1</span></code> 和 <code class="docutils literal notranslate"><span class="pre">Rs=40</span></code> 为例设计模拟滤波器，幅频响应如下图所示</p>
<div class="figure align-center" style="width: 60%">
<img alt="../_images/filter02.png" src="../_images/filter02.png" />
</div>
<p>可见，在相同需求下：
- 巴特沃斯滤波器通带平坦，阻带无纹波，但阶数最高；
- 切比雪夫 I 型滤波器通带有纹波，阻带无纹波，阶数适中；
- 切比雪夫 II 型滤波器通带无纹波，阻带有纹波，阶数适中；
- 椭圆滤波器通带和阻带均有纹波，但阶数最少。</p>
</div>
<div class="section" id="fir">
<h2>FIR 滤波器设计<a class="headerlink" href="#fir" title="永久链接至标题">¶</a></h2>
<p>FIR 滤波器是一种全零点数字滤波器，与 IIR 滤波器相比，不存在系统稳定性问题，且具有良好的线性相位（滤波引入的延时是恒定的）。但是为了达到相同的频率相应，FIR滤波器通常需要更高的阶数。</p>
<p>在 MATLAB 中，可以使用 <code class="docutils literal notranslate"><span class="pre">fir1</span></code> 或 <code class="docutils literal notranslate"><span class="pre">fir2</span></code> 进行FIR滤波器设计，前者基于窗函数设计法，设计时只需要给定滤波器阶数和带宽即可；后者基于频率采样设计法，设计时要给定阶数、频率和目标增益。</p>
<p>对于 Python 用户，相应的函数由 <code class="docutils literal notranslate"><span class="pre">scipy.signal</span></code> 包提供，分别为 <code class="docutils literal notranslate"><span class="pre">firwin</span></code> 和 <code class="docutils literal notranslate"><span class="pre">firwin2</span></code> ，用法也是完全一致。</p>
<p>由于 FIR 滤波器的设计没有明确给定通带纹波、阻带衰减等特性，设计完成后通常需要验证其是否满足需求。</p>
</div>
<div class="section" id="id3">
<h2>零相位滤波<a class="headerlink" href="#id3" title="永久链接至标题">¶</a></h2>
<p>数字滤波器的本质是差分方程，因此可以将滤波器系数转化为差分方程的系数，通过迭代实现滤波。这种动态相应通常以延时的形式表现在输出信号，如果滤波器的延时过大，可能对后续的过程产生影响。为了补偿滤波器引入的延时，有三种常用的方法：</p>
<ul class="simple">
<li><p>互相关校准：将输出和输入的互相关来评估系统延时从而进一步补偿；</p></li>
<li><p>全通滤波器：这种滤波器在全频带内的增益都是恒定的，用于调整系统的相位以补偿前置滤波器引入的群延时；</p></li>
<li><p>零相位滤波：一种非因果的滤波技术，可以对延时进行补偿。</p></li>
</ul>
<p>这里主要介绍零相位滤波，其实现方法主要有以下四步：</p>
<ol class="arabic simple">
<li><p>使用通常的滤波手段（差分方程）对数据进行滤波；</p></li>
<li><p>将滤波后的数据进行时域翻转；</p></li>
<li><p>将翻转后的数据再次滤波；</p></li>
<li><p>再次进行时域翻转。</p></li>
</ol>
<p>从感性上看，第一次滤波是从前往后滤，因此向后引入了延时；第二次滤波是从后往前滤，向前引入的相同的“延时”。由于采用的是完全相同的滤波器，因而延时可以完全抵消。</p>
<p>为了使用滤波器，在 MATLAB 中可以使用 <code class="docutils literal notranslate"><span class="pre">filter(b,a,x)</span></code> 进行滤波，也可以使用 <code class="docutils literal notranslate"><span class="pre">filtfilt(b,a,x)</span></code> 进行零相位滤波。在Python中，这两个函数分别对应于 <code class="docutils literal notranslate"><span class="pre">scipy.signal</span></code> 中的 <code class="docutils literal notranslate"><span class="pre">lfilter</span></code> 和 <code class="docutils literal notranslate"><span class="pre">filtfilt</span></code> 。下图给出同一个滤波器使用两种滤波方法对带噪声的正弦信号滤波后的结果。</p>
<div class="figure align-center" style="width: 60%">
<img alt="../_images/filter03.png" src="../_images/filter03.png" />
</div>
<p>一般的滤波方法引入了可见的延时，而零相位滤波器没有引入明显延时。此外，相同滤波器下，零相位滤波器的输出结果更光滑，这是因为它对数据进行了两次滤波，其增益特性将是一次滤波的平方。需要注意的是，一般的滤波只在数据的开始阶段存在过渡过程，而零相位滤波在数据两端都有过渡过程。为了消除这些过渡过程，可以使用自适应技术提前对数据进行一定程度的预测。</p>
<p>零相位滤波是在数据采集完成之后才能进行的操作，不能实时处理，这也就是所谓“非因果系统”的实际含义。对于实时系统，只能通过其他的手段对延时进行补偿。</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="lpsd.html" class="btn btn-neutral float-right" title="LPSD 功率谱估计" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="signal_diff.html" class="btn btn-neutral float-left" title="信号的微分" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; 版权所有 2021, 大春雨.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
    <p xmlns:cc="http://creativecommons.org/ns#" > 本站采用 <a href="http://creativecommons.org/licenses/by/4.0/?ref=chooser-v1" target="_blank" rel="license noopener noreferrer" style="display:inline-block;"><img style="height:21px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1"><img style="height:21px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1"> CC BY 4.0 </a> 许可协议，转载请注明出处。</p> 


</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>