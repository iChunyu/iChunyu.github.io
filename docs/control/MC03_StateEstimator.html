

<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>现代控制基础（3）：状态估计器 &mdash; 某春雨的后花园  文档</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/translations.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="next" title="现代控制基础（4）：调节器设计" href="MC04_Regulator.html" />
    <link rel="prev" title="现代控制基础（2）：状态反馈" href="MC02_StateFeedback.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> 某春雨的后花园
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">目录</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../misc/index.html">杂乱的技能树</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">控制理论学习记录</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="MC01_SysDescribe.html">现代控制基础（1）：系统的描述</a></li>
<li class="toctree-l2"><a class="reference internal" href="MC02_StateFeedback.html">现代控制基础（2）：状态反馈</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">现代控制基础（3）：状态估计器</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id2">全维状态估计器</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">降维状态估计器</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">参考资料</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="MC04_Regulator.html">现代控制基础（4）：调节器设计</a></li>
<li class="toctree-l2"><a class="reference internal" href="MC05_Reference.html">现代控制基础（5）：参考的引入</a></li>
<li class="toctree-l2"><a class="reference internal" href="MC06_RobustTracking.html">现代控制基础（6）：鲁棒跟踪控制</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../demo/index.html">控制系统应用示例</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dsp/index.html">数字信号处理</a></li>
<li class="toctree-l1"><a class="reference internal" href="../latex/index.html">LaTeX 学习记录</a></li>
<li class="toctree-l1"><a class="reference internal" href="../matlab/index.html">MATLAB 使用技巧</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">某春雨的后花园</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">控制理论学习记录</a> &raquo;</li>
        
      <li>现代控制基础（3）：状态估计器</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/control/MC03_StateEstimator.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="id1">
<h1>现代控制基础（3）：状态估计器<a class="headerlink" href="#id1" title="永久链接至标题">¶</a></h1>
<p>前面讨论了利用系统状态进行反馈的方法，而可知的信息只有被控对象输入的控制信号 <span class="math notranslate nohighlight">\(u\)</span> 和传感器测得的输出 <span class="math notranslate nohighlight">\(y\)</span> ，因此需要所谓的状态估计器对系统的状态进行估计。</p>
<div class="section" id="id2">
<h2>全维状态估计器<a class="headerlink" href="#id2" title="永久链接至标题">¶</a></h2>
<p>设线性时不变被控对象的状态空间表述为：</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left\{
\begin{aligned}
\dot{\mathbf{x}} &amp;= A \mathbf{x} + Bu  \\
y &amp;= C \mathbf{x}
\end{aligned}
\right.\end{split}\]</div>
<p>据此，构建相同的理论模型：</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left\{
\begin{aligned}
\dot{\hat{\mathbf{x}}} &amp;= A \hat{\mathbf{x}} + Bu  \\
\hat{y} &amp;= C \hat{\mathbf{x}}
\end{aligned}
\right.\end{split}\]</div>
<p>在该理论模型中，带帽子的变量（如 <span class="math notranslate nohighlight">\(\hat{x}\)</span> ）表示估计值。由于是理论模型，其所有信息都可以通过计算机获得。理论模型和被控对象输入相同的 <span class="math notranslate nohighlight">\(u\)</span> 时，原则上两者的响应相同，因而状态和输出都应当相同。然而实际上，由于被控对象和理论模型初始状态的偏差、理论模型的建模误差、被控对象的额外扰动、传感器的测量噪声等因素的影响，实际输出和理论输出并不相同，因而状态也不相同。</p>
<p><strong>When in trouble, use feedback</strong> 。为了解决模型之间的差异，遵循这个控制的金科玉律，对理论模型引入反馈进行矫正，令：</p>
<div class="math notranslate nohighlight">
\[\mathbf{\dot{\hat{x}}} = A\hat{\mathbf{x}} + { B}u + {L}\left( {y - \hat y} \right)\]</div>
<p>此时状态的估计误差 <span class="math notranslate nohighlight">\({\mathbf{\tilde x}} = {\mathbf{x}} - {\mathbf{\hat{x}}}\)</span> 满足：</p>
<div class="math notranslate nohighlight">
\[\mathbf{\dot{\tilde{x}}} = \left( A - LC \right) \mathbf{\tilde{x}}\]</div>
<p>于是，只要合理设计 <span class="math notranslate nohighlight">\(L\)</span> 令 <span class="math notranslate nohighlight">\(\left( A - LC \right)\)</span> 所有特征值的实部均小于零即可使状态估计误差收敛到零，即状态估计值趋近于真是状态。</p>
<p>状态估计器 <span class="math notranslate nohighlight">\(L\)</span> 的设计与状态反馈 <span class="math notranslate nohighlight">\(K\)</span> 的设计完全相同，考察数学关系：</p>
<div class="math notranslate nohighlight">
\[\left| {{A} - {LC}} \right| = \left| {{{\left( {{A} - {LC}} \right)}^T}} \right| = \left| {{{A}^T} - {{C}^T}{{L}^T}} \right| \leftarrow \left| A - BK \right|\]</div>
<p>即：状态观测器与控制律之间存在对偶关系，设计时只需分别将 <span class="math notranslate nohighlight">\(A\)</span> 、 <span class="math notranslate nohighlight">\(C\)</span> 、 <span class="math notranslate nohighlight">\(L\)</span> 置后采用与状态反馈相同的方法进行极点配置（特征值设计）。</p>
<p>下面给出一个全维状态估计器的例子。</p>
<p>设弹簧-质量-阻尼系统的状态空间为：</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left\{
\begin{aligned}
\dot{\mathbf{x}} &amp;= \begin{bmatrix}
    0 &amp; 1 \\
    -\omega_n^2 &amp; -2\zeta \omega
\end{bmatrix}
\mathbf{x} + \begin{bmatrix}
    0 \\ \omega_n^2
\end{bmatrix}u  \\
y &amp;= \begin{bmatrix}
1 &amp; 0
\end{bmatrix}\mathbf{x}\
\end{aligned}
\right.\end{split}\]</div>
<p>其中， <span class="math notranslate nohighlight">\(\omega_n=1 {\rm  rad/s,  } \zeta=0.3\)</span> ，基于Simulink搭建被控对象如图所示</p>
<div class="figure align-center" style="width: 80%">
<img alt="../_images/mc03a.png" src="../_images/mc03a.png" />
</div>
<p>为了状态估计能够快速收敛，设的阻尼系数 <span class="math notranslate nohighlight">\(\zeta=0.7\)</span> ，对应极点为 <span class="math notranslate nohighlight">\(-0.70\pm0.71j\)</span> ，进而 <span class="math notranslate nohighlight">\(L=\left[0.80,\, -0.48\right]\)</span> 。带入仿真，观察状态的实际值和估计值如下图所示：</p>
<div class="figure align-center" style="width: 60%">
<img alt="../_images/mc03b.png" src="../_images/mc03b.png" />
</div>
<p>第一个子图实线为真实状态，虚线为状态估计值，可见两者在大约5s后趋于一致。第二个子图则表示两个状态的估计误差，同样可以反应状态估计值的误差随时间收敛到零，状态估计值趋于真实值。</p>
</div>
<div class="section" id="id3">
<h2>降维状态估计器<a class="headerlink" href="#id3" title="永久链接至标题">¶</a></h2>
<p>上面介绍的状态估计器称之为全维状态估计器，因为它对系统的所有状态都进行了估计。然而，在一些情况下，系统的输出就是系统的某一个状态，能否直接利用这个状态，仅对其他状态进行估计呢？这时就需要用降维状态估计器。</p>
<p>以单输入单输出系统（SISO，Single Input Sigle Output）为例，将其状态空间方程拆解为：</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left\{ {\begin{array}{*{20}{l}}
  {\left[ {\begin{array}{*{20}{c}}
  {{{\dot x}_a}} \\
  \dot{\mathbf{x}}_b
\end{array}} \right] = \left[ {\begin{array}{*{20}{c}}
  {{A_{aa}}}&amp;{{{A}_{ab}}} \\
  {{A_{ba}}}&amp;{{{A}_{bb}}}
\end{array}} \right]\left[ {\begin{array}{*{20}{c}}
  {{x_a}} \\
  {{{\mathbf{x}}_b}}
\end{array}} \right] + \left[ {\begin{array}{*{20}{c}}
  {{B_a}} \\
  {{{ B}_b}}
\end{array}} \right]u} \\
  {y = \left[ {\begin{array}{*{20}{c}}
  1&amp;0
\end{array}} \right]\left[ {\begin{array}{*{20}{c}}
  {{x_a}} \\
  {{{\mathbf{x}}_b}}
\end{array}} \right]}
\end{array}} \right.\end{split}\]</div>
<p>系统的输出就是状态量 <span class="math notranslate nohighlight">\(x_a\)</span> ，需要进行估计的状态为 <span class="math notranslate nohighlight">\(\mathbf{x}_b\)</span> 。</p>
<p>为了实现降维，需要对原始的状态空间方程进行改造，构造新的系统，使其状态变量有且仅有 <span class="math notranslate nohighlight">\(\mathbf{x}_b\)</span> 。</p>
<p>首先从 <span class="math notranslate nohighlight">\(\dot{\mathbf{x}}_b\)</span> 的方程中寻找新的系统输入方程：</p>
<div class="math notranslate nohighlight">
\[\dot{\mathbf{x}}_b = {{A}_{bb}}{{\mathbf{x}}_b} + \left( {{A_{ba}}{x_a} + {{ B}_b}u} \right)\]</div>
<p>将 <span class="math notranslate nohighlight">\(\dot{x}_a\)</span> 换为输出的导数 <span class="math notranslate nohighlight">\(\dot{y}\)</span> ，改写系统的输出方程：</p>
<div class="math notranslate nohighlight">
\[\left( {\dot{y} - {A_{aa}}{x_a} - {B_a}u} \right) = {{A}_{ab}}{{\mathbf{x}}_b}\]</div>
<p>由上面两个式子，对比标准的状态空间方程，显然有以下转换关系：</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left\{ \begin{array}{l}
{\bf{x}} \to {{\bf{x}}_b}\\
{A} \to {{A}_{bb}}\\
{B}u \to \left( {{A_{ba}}{x_a} + {{B}_b}u} \right)\\
C \to {{A}_{ab}}\\
y \to \left( {\dot y - {A_{aa}}{x_a} - {B_a}u} \right)
\end{array} \right.\end{split}\]</div>
<p>根据全维状态估计器的设计方法，对这个转换后的”新系统“进行状态估计器设计，有</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\dot{\hat{\mathbf{x}}}_b &amp;= {{A}_{bb}}{{{\bf{\hat x}}}_b} + \left( {{A_{ba}}{x_a} + {{B}_b}u} \right) + {{L}_b}\left[ {\left( {\dot y - {A_{aa}}{x_a} - {B_a}u} \right) - {{A}_{ab}}{{{\bf{\hat x}}}_b}} \right] \\
&amp;= \left( {{{A}_{bb}} - {{L}_b}{{A}_{ab}}} \right){{{\bf{\hat x}}}_b} + \left( {{A_{ba}} - {{L}_b}{A_{aa}}} \right)y + \left( {{{B}_b} - {{L}_b}{B_a}} \right)u + {{L}_b}\dot y
\end{aligned}\end{split}\]</div>
<p>由此初步完成了降维估计器的构造，设计的目标只需令 <span class="math notranslate nohighlight">\({{{A}_{bb}} - {{L}_b}{{A}_{ab}}}\)</span> 的所有特征值实部为负。需要注意的是，上式中包含输出的导数 <span class="math notranslate nohighlight">\(\dot{y}\)</span> ，实际中微分是不容易实现的，且容易放大高频噪声，应当避免这一项的存在。于是需要进一步构造辅助变量 <span class="math notranslate nohighlight">\({{\mathbf{x}}_c} = {{{\mathbf{\hat x}}}_b} - {L}_by\)</span> ，则上式改为：</p>
<div class="math notranslate nohighlight">
\[\dot{\hat{\mathbf{x}}}_c = \left( {{{A}_{bb}} - {{L}_b}{{A}_{ab}}} \right)\left( {{{\bf{x}}_c} + {{L}_b}y} \right) + \left( {{A_{ba}} - {{L}_b}{A_{aa}}} \right)y + \left( {{{B}_b} - {{L}_b}{B_a}} \right)u\]</div>
<p>至此，推导出降维状态估计器的可实现的形式。对于本文所提及的弹簧-质量-阻尼系统，其降维状态估计器结构如下图所示：</p>
<div class="figure align-center" style="width: 60%">
<img alt="../_images/mc03c.png" src="../_images/mc03c.png" />
</div>
<p>对降维状态估计器进行参数设计，之后得到该估计器的响应如图：</p>
<div class="figure align-center" style="width: 60%">
<img alt="../_images/mc03d.png" src="../_images/mc03d.png" />
</div>
<p>该降维状态估计器仅对状态量 <span class="math notranslate nohighlight">\(x_2\)</span> 进行估计，可见在8s左右估计的误差已收敛到合适的范围，随着时间的增长，状态估计误差收敛于零，状态估计值收敛于真实值。</p>
<div class="admonition note">
<p class="admonition-title">注解</p>
<p>全维状态估计器还是降维状态估计器？这是一个开放性的问题，全维状态估计器的所有状态响应都有一定的收敛过程，而降维状态估计器利用系统输出作为已知状态，仅被估计的状态存在收敛过程，从这一方面看，降维状态估计器具有“更快”的效果；然而，降维估计器中对应于系统输出的状态容易受到传感器噪声的影响，而全维状态估计可以对噪声进行滤波，因而全维状态估计器具有“更低噪声”的效果。</p>
</div>
</div>
<div class="section" id="id4">
<h2>参考资料<a class="headerlink" href="#id4" title="永久链接至标题">¶</a></h2>
<ol class="arabic simple">
<li><ol class="upperalpha simple" start="7">
<li><ol class="upperalpha simple" start="6">
<li><p>Franklin, J. D. Powell, and A. Emami-Naeini, Feedback Control of Dynamic Systems, 7th ed. Upper SaddleRiver, NJ, USA: Prentice Hall Press, 2014.</p></li>
</ol>
</li>
</ol>
</li>
</ol>
<p>另请参阅： <a class="reference external" href="https://github.com/iChunyu/LearnCtrlSys/blob/master/ModernControl/note2_StateEstimator.mlx">状态估计仿真测试</a></p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="MC04_Regulator.html" class="btn btn-neutral float-right" title="现代控制基础（4）：调节器设计" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="MC02_StateFeedback.html" class="btn btn-neutral float-left" title="现代控制基础（2）：状态反馈" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; 版权所有 2021, 大春雨.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>